<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- account.move -->

    <record id="initialiser_affaire_action_server" model="ir.actions.server">
        <field name="name">Initialiser affaire</field>
        <field name="model_id" ref="account.model_account_move"/>
        <field name="binding_model_id" ref="account.model_account_move"/>
        <field name="state">code</field>
        <field name="code">records.initialiser_affaire_action()</field>
    </record>
    <record id="initialiser_compte_vente_action_server" model="ir.actions.server">
        <field name="name">Initialiser compte de vente</field>
        <field name="model_id" ref="account.model_account_move"/>
        <field name="binding_model_id" ref="account.model_account_move"/>
        <field name="state">code</field>
        <field name="code">records.initialiser_compte_vente_action()</field>
    </record>

    <record id="is_view_move_form" model="ir.ui.view">
        <field name="name">is_view_move_form</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">
            <xpath expr="//sheet[1]" position="inside">
                <style>
                    .o_form_view .o_form_sheet_bg > .o_form_sheet{
                        max-width: 1800px;
                    }
                    .o_form_label{
                        white-space: nowrap;
                    }
                    .modal-lg, .modal-xl {
                        max-width: 1400px;
                    }
                </style>
            </xpath>
            <button name="action_post" position="after">
                <button 
                    name="enregistre_courrier_action" 
                    string="Enregistrer courrier expédié" 
                    class="oe_highlight" 
                    type="object"
                    attrs="{
                        'invisible': [
                            '|','|',
                            ('move_type', 'in', ['in_invoice','in_refund']),
                            ('state', 'not in', ['posted']),
                            ('is_courrier_id', '!=', False),
                        ],
                        'readonly': True
                    }"
                />
            </button>
            <field name="partner_bank_id" position="after">
                <field name="is_attente_avoir"   attrs="{'invisible': [('move_type', 'in', ['out_invoice','out_refund'])]}"/>
            </field>
            <field name="ref" position="replace"/>
            <field name="payment_reference" position="after">
                <field name="is_order_id"   attrs="{'invisible': [('move_type', 'in', ['in_invoice','in_refund'])]}"/>
                <field name="is_affaire_id" attrs="{'invisible': [('move_type', 'in', ['in_invoice','in_refund'])]}"/>
                <field name="is_situation"  attrs="{'invisible': [('move_type', 'in', ['in_invoice','in_refund'])]}"/>
                <field name="ref" string="Référence client" attrs="{'invisible': [('move_type', 'in', ['in_invoice','in_refund'])]}"/>
                <field name="is_banque_id"  attrs="{'invisible': [('is_banque_id', '=', False)]}"/>
            </field>
            <xpath expr="//page[@id='invoice_tab']/field[@name='invoice_line_ids']/tree/field[@name='quantity']" position="before">
                <field name="is_sale_line_id"        optional="hide"/>
                <field name="is_qt_commande"         optional="hide"/>
                <field name="is_facturable_pourcent" optional="hide"/>
                <field name="is_a_facturer"          optional="hide" sum="Total"/>
            </xpath>
            <xpath expr="//page[@id='invoice_tab']/field[@name='invoice_line_ids']/tree/field[@name='analytic_tag_ids']" position="after">
                <field name="is_affaire_id" optional="hide" class="white_space_normal"/>
            </xpath>
            <xpath expr="//page[@id='aml_tab']/field[@name='line_ids']/tree/field[@name='name']" position="after">
                <field name="is_affaire_id" optional="hide" class="white_space_normal"/>
            </xpath>
            <label for="invoice_payment_term_id" position="replace"/>
            <xpath expr="//field[@name='invoice_date_due']/.." position="replace">
                <field name="invoice_payment_term_id"/>
                <field name="invoice_date_due"/>
            </xpath>
            <xpath expr="//field[@name='invoice_line_ids']/tree" position="attributes">
                <attribute name="limit">1000</attribute>
            </xpath>
            <div name="journal_div" position="after">
                <field name="is_export_compta_id"/>
                <field name="is_traite_id"/>
                <field 
                    name="is_courrier_id"
                    attrs="{'invisible': [('is_courrier_id', '=', False)], 'readonly': True}"
                />
                <field 
                    name="is_a_facturer"
                    attrs="{'invisible': [('is_a_facturer', '=', 0)], 'readonly': True}"
                />
                <field 
                    name="is_facture"
                    attrs="{'invisible': [('is_facture', '=', 0)], 'readonly': True}"
                />
            </div>
        </field>
    </record> 
    <record id="is_view_out_invoice_tree" model="ir.ui.view">
        <field name="name">is_view_out_invoice_tree</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_out_invoice_tree" />
        <field name="arch" type="xml">
            <field name="invoice_date" position="before">
                <field name="is_affaire_id" optional="show" class="white_space_normal"/>
            </field>
            <field name="invoice_date_due" position="before">
                <field name="invoice_payment_term_id" optional="show"/>
                <field name="invoice_date_due"/>
            </field>
            <field name="state" position="before">
                <field name="is_export_compta_id" optional="show"/>
                <field name="is_courrier_id"      optional="show"/>
            </field>
            <!-- <field name="state" position="after">
                <field name="active" optional="hide"/>
            </field> -->
        </field>
    </record>
    <record id="is_view_in_invoice_tree" model="ir.ui.view">
        <field name="name">is_view_in_invoice_tree</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_in_invoice_tree" />
        <field name="arch" type="xml">
            <field name="partner_id" position="after">
                <!-- <field name="purchase_id" optional="hide"/> -->
                <field name="is_affaire_id" optional="show" class="white_space_normal"/>
            </field>
            <field name="invoice_date_due" position="before">
                <field name="invoice_payment_term_id" optional="show"/>
                <field name="invoice_date_due"        optional="show"/>
            </field>
            <field name="state" position="before">
                <field name="is_attente_avoir"    optional="hide"/>
                <field name="is_banque_id"        optional="hide"/>
                <field name="is_export_compta_id" optional="show"/>
                <field name="is_traite_id"        optional="show"/>
            </field>
        </field>
    </record>
    <record id="is_view_invoice_tree" model="ir.ui.view">
        <field name="name">is_view_invoice_tree</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_invoice_tree" />
        <field name="arch" type="xml">
            <field name="activity_ids" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <!-- <tree position="attributes">
                <attribute name="default_order">name</attribute>
            </tree> -->
        </field>
    </record>
    <record id="is_view_account_invoice_filter" model="ir.ui.view">
        <field name="name">is_view_invoice_tree</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_account_invoice_filter" />
        <field name="arch" type="xml">
            <filter name="myinvoices" position="after">
                <filter domain="[('is_attente_avoir', '!=', False)]" string="Attente avoir" name="attente_avoir" help="Attente avoir"/>
            </filter>
            <field name="partner_id" position="after">
                <field name="is_affaire_id"/>
            </field>
        </field>
    </record>


    <!-- account.move.line -->
    <record id="is_account_move_line_form_view" model="ir.ui.view">
        <field name="name">is_account_move_line_form_view</field>
        <field name="model">account.move.line</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group>
                        <group>
                            <field name="move_id" readonly="1"/>
                            <field name="partner_id" readonly="1"/>
                            <field name="product_id" readonly="1"/>
                            <field name="name" readonly="1"/>
                            <field name="is_affaire_id"/>
                            <field name="account_id" readonly="1"/>
                            <field name="quantity" readonly="1"/>
                            <field name="product_uom_category_id" invisible="1"/>
                            <field name="product_uom_id" readonly="1"/>
                            <field name="price_unit" readonly="1"/>
                            <field name="price_subtotal" readonly="1"/>

                            <field name="is_sale_line_id" readonly="1"/>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>
    <record model="ir.ui.view" id="is_account_move_line_tree_view">
        <field name="name">is_account_move_line_tree_view</field>
        <field name="model">account.move.line</field>
        <field name="type">tree</field>
        <field name="arch" type="xml">
            <tree>
                <field name="move_id"/>
                <field name="partner_id"/>
                <field name="product_id"/>
                <field name="is_famille_id" optional="hide"/>
                <field name="name"/>
                <field name="is_affaire_id" class="white_space_normal" optional="hide"/>
                <field name="account_id"/>
                <field name="quantity" sum="Total"/>
                <field name="product_uom_category_id" invisible="1"/>
                <field name="product_uom_id"/>
                <field name="price_unit"/>
                <field name="price_subtotal" sum="Total"/>
            </tree>
        </field>
    </record>
    <record id="is_account_move_line_action" model="ir.actions.act_window">
        <field name="name">Lignes de factures</field>
        <field name="res_model">account.move.line</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="is_clair_sarl.is_account_move_line_tree_view"/>
    </record>
</odoo>
