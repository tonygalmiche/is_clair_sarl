<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- purchase.order  -->
    <record id="is_purchase_order_form" model="ir.ui.view">
        <field name="name">is_purchase_order_form</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//sheet[1]" position="inside">
                <style>
                    .o_form_view .o_form_sheet_bg > .o_form_sheet{
                        max-width: 1800px;
                    }
                    .o_form_label{
                        white-space: nowrap;
                    }
                </style>
            </xpath>
            <field name="partner_id" position="after">
                <field name="is_affaire_id"/>
            </field>
            <field name="date_order" position="before">
                <field name="is_date"/>
                <label for="is_delai"/>
                <div class="d-flex">
                    <field name="is_delai_mois_id" placeholder="Mois / Trimestre"/>
                    <span class="o_form_label mx-3"> </span>
                    <field name="is_delai_annee"   placeholder="Année"/>
                </div>
                <field name="is_delai" invisible="1"/>
                <field name="is_date_livraison"/>
                <field name="is_lieu_livraison"/>
            </field>
            <field name="date_order" position="attributes">
                 <attribute name="invisible">1</attribute>
            </field>

            <label for="date_planned" position="attributes">
                 <attribute name="invisible">1</attribute>
            </label>

            <div name="date_planned_div" position="attributes">
                 <attribute name="invisible">1</attribute>
            </div>

            <div name="reminder" position="attributes">
                 <attribute name="invisible">1</attribute>
            </div>

            <label for="date_approve" position="attributes">
                 <attribute name="invisible">1</attribute>
            </label>
            <div name="date_approve" position="attributes">
                 <attribute name="invisible">1</attribute>
            </div>
            <notebook position="before">
                <div style="background:orange;color:white;font-weight:bold;padding-left:5pt" attrs="{'invisible':[('is_condition_tarifaire','=',False)]}">
                    <field 
                        name="is_condition_tarifaire"
                        readonly="1" nolabel="1" 
                    />
                </div>
            </notebook>
            <xpath expr="//page[@name='products']/field[@name='order_line']/tree" position="attributes">
                <attribute name="editable"></attribute>
            </xpath>
            <xpath expr="//page[@name='products']/field[@name='order_line']/tree/field[@name='name']" position="before">
                <field name="is_finition_id"   optional="show"/>
                <field name="is_traitement_id" optional="show"/>
            </xpath>
            <xpath expr="//page[@name='products']/field[@name='order_line']/tree/field[@name='product_qty']" position="before">
                <field name="is_colisage" optional="hide" widget="html"/>
                <field name="is_liste_colis_action_vsb" invisible="1"/>
                <button 
                    name="liste_colis_action" 
                    type="object" icon="fa-list-ul" 
                    title="Liste des colis"
                    attrs="{'invisible':[('is_liste_colis_action_vsb','=',False)]}"
                />
                <button 
                    name="liste_lignes_colis_action" 
                    type="object" icon="fa-list" 
                    title="Liste des lignes des colis"
                    attrs="{'invisible':[('is_liste_colis_action_vsb','=',False)]}"
                />
            </xpath>
            <xpath expr="//page[@name='products']/field[@name='order_line']/form/group/group/field[@name='date_planned']" position="attributes">
                 <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//page[@name='products']/field[@name='order_line']/form/group/group/field[@name='date_planned']" position="after">
                <field name="is_finition_id"/>
                <field name="is_traitement_id"/>
            </xpath>
            <xpath expr="//page[@name='products']" position="after">
                <page string="Repères de plan">
                    <group>
                        <group>
                            <field name="is_repere_ids" nolabel="1">
                                <tree editable="bottom">
                                    <field name="repere"/>
                                    <field name="montant" sum="Total"/>
                                </tree>
                            </field>
                        </group>
                        <group>
                            <field name="is_mois_ids" nolabel="1">
                                <tree editable="bottom">
                                    <field name="mois"/>
                                    <field name="montant" sum="Total"/>
                                </tree>
                            </field>
                        </group>
                    </group>
                </page>
            </xpath>
            <xpath expr="//page[@name='products']/field[@name='order_line']/form/group/group/notebook/page[@name='notes']" position="after">
                <page string="Repères de plan">
                    <group>
                        <field name="is_repere_ids" nolabel="1">
                            <tree editable="bottom">
                                <field name="repere_id" readonly="1"/>
                                <field name="formule"/>
                                <field name="quantite"  readonly="1" sum="Total"/>
                                <field name="montant"                sum="Total"/>
                            </tree>
                        </field>
                    </group>
                    <group>
                        <field name="is_mois_ids" nolabel="1">
                            <tree editable="bottom">
                                <field name="mois_id" readonly="1"/>
                                <field name="formule"/>
                                <field name="quantite"  readonly="1" sum="Total"/>
                                <field name="montant"                sum="Total"/>
                            </tree>
                        </field>
                    </group>
                </page>
            </xpath>
        </field>
    </record>



    <record id="is_purchase_order_kpis_tree" model="ir.ui.view">
        <field name="name">is_purchase_order_kpis_tree</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_kpis_tree"/>
        <field name="arch" type="xml">
            <field name="partner_id" position="after">
                <field name="is_affaire_id"/>
                <field name="is_date"  optional="show"/>
                <field name="is_delai" optional="show"/>
                <field name="is_date_livraison" optional="show"/>
                <field name="is_lieu_livraison" optional="show"/>
            </field>
            <field name="date_order" position="replace"/>
            <field name="user_id" position="replace"/>
        </field>
    </record>
    <record id="is_purchase_order_view_tree" model="ir.ui.view">
        <field name="name">is_purchase_order_view_tree</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_view_tree"/>
        <field name="arch" type="xml">
            <field name="partner_id" position="after">
                <field name="is_affaire_id"/>
                <field name="is_date"           optional="show"/>
                <field name="is_delai"          optional="show"/>
                <field name="is_date_livraison" optional="show"/>
                <field name="is_lieu_livraison" optional="show"/>
            </field>
            <field name="date_planned" position="replace"/>
            <field name="user_id" position="replace"/>
        </field>
    </record>


    <!--is.finition -->
    <record id="is_finition_form_view" model="ir.ui.view">
        <field name="name">is_finition_from_view</field>
        <field name="model">is.finition</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group>
                        <group>
                            <field name="name" />
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>
    <record model="ir.ui.view" id="is_finition_tree_view">
        <field name="name">is_finition_tree_view</field>
        <field name="model">is.finition</field>
        <field name="type">tree</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name" />
            </tree>
        </field>
    </record>
    <record id="is_finition_search_view" model="ir.ui.view">
        <field name="name">is_finition_search_view</field>
        <field name="model">is.finition</field>
        <field name="arch" type="xml">
            <search>
                <field name="name" />
            </search>
        </field>
    </record>
    <record id="is_finition_action" model="ir.actions.act_window">
        <field name="name">Finitions</field>
        <field name="res_model">is.finition</field>
        <field name="view_mode">tree,form</field>
    </record>


    <!--is.traitement -->
    <record id="is_traitement_form_view" model="ir.ui.view">
        <field name="name">is_traitement_from_view</field>
        <field name="model">is.traitement</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group>
                        <group>
                            <field name="name" />
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>
    <record model="ir.ui.view" id="is_traitement_tree_view">
        <field name="name">is_traitement_tree_view</field>
        <field name="model">is.traitement</field>
        <field name="type">tree</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name" />
            </tree>
        </field>
    </record>
    <record id="is_traitement_search_view" model="ir.ui.view">
        <field name="name">is_traitement_search_view</field>
        <field name="model">is.traitement</field>
        <field name="arch" type="xml">
            <search>
                <field name="name" />
            </search>
        </field>
    </record>
    <record id="is_traitement_action" model="ir.actions.act_window">
        <field name="name">Traitement</field>
        <field name="res_model">is.traitement</field>
        <field name="view_mode">tree,form</field>
    </record>


    <!--is.mois.trimestre -->
    <record id="is_mois_trimestre_form_view" model="ir.ui.view">
        <field name="name">is_mois_trimestre_from_view</field>
        <field name="model">is.mois.trimestre</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group>
                        <group>
                            <field name="name" />
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>
    <record model="ir.ui.view" id="is_mois_trimestre_tree_view">
        <field name="name">is_mois_trimestre_tree_view</field>
        <field name="model">is.mois.trimestre</field>
        <field name="type">tree</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name" />
            </tree>
        </field>
    </record>
    <record id="is_mois_trimestre_search_view" model="ir.ui.view">
        <field name="name">is_mois_trimestre_search_view</field>
        <field name="model">is.mois.trimestre</field>
        <field name="arch" type="xml">
            <search>
                <field name="name" />
            </search>
        </field>
    </record>
    <record id="is_mois_trimestre_action" model="ir.actions.act_window">
        <field name="name">Mois / Trimestre</field>
        <field name="res_model">is.mois.trimestre</field>
        <field name="view_mode">tree,form</field>
    </record>


    <!--is.purchase.order.line.colis -->
    <record id="is_purchase_order_line_colis_form_view" model="ir.ui.view">
        <field name="name">is_purchase_order_line_colis_from_view</field>
        <field name="model">is.purchase.order.line.colis</field>
        <field name="arch" type="xml">
            <form>
                <style>
                    .o_form_label{
                        white-space: nowrap;
                    }
                </style>
                <sheet>
                    <group>
                        <group>
                            <field name="product_id"/>
                            <field name="line_id" invisible="1"/>
                            <field name="name"/>
                            <field name="surface"       invisible="1"/>
                            <field name="forfait_coupe" invisible="1"/>


                        </group>
                        <group>
                            <field name="largeur_utile"/>
                            <field name="poids"/>
                            <field name="poids_colis"/>
                            <field name="forfait_coupe_id"/>
                        </group>
                    </group>
                    <group>
                        <field name="line_ids" nolabel="1">
                            <tree editable="bottom">
                                <field name="colis_id" invisible="1"/>
                                <field name="nb"            sum="Total"/>
                                <field name="longueur"      sum="Total"/>
                                <field name="note"/>
                                <field name="surface"       sum="Total"/>
                                <field name="poids"         sum="Total"/>
                                <field name="forfait_coupe" sum="Total"/>
                            </tree>
                        </field>
                    </group>
                </sheet>
            </form>
        </field>
    </record>
    <record model="ir.ui.view" id="is_purchase_order_line_colis_tree_view">
        <field name="name">is_purchase_order_line_colis_tree_view</field>
        <field name="model">is.purchase.order.line.colis</field>
        <field name="type">tree</field>
        <field name="arch" type="xml">
            <tree>
                <field name="line_id" invisible="1"/>
                <field name="name"/>
                <field name="surface"       sum="Total"/>
                <field name="poids"/>
                <field name="poids_colis"   sum="Total"/>
                <field name="forfait_coupe" sum="Total"/>
                <field name="forfait_coupe_id"/>
            </tree>
        </field>
    </record>
    <record id="is_purchase_order_line_colis_search_view" model="ir.ui.view">
        <field name="name">is_purchase_order_line_colis_search_view</field>
        <field name="model">is.purchase.order.line.colis</field>
        <field name="arch" type="xml">
            <search>
                <field name="name" />
            </search>
        </field>
    </record>
    <record id="is_purchase_order_line_colis_action" model="ir.actions.act_window">
        <field name="name">Colis</field>
        <field name="res_model">is.purchase.order.line.colis</field>
        <field name="view_mode">tree,form</field>
    </record>




    <!--is.purchase.order.line.colis.line -->
    <record id="is_purchase_order_line_colis_line_form_view" model="ir.ui.view">
        <field name="name">is_purchase_order_line_colis_line_from_view</field>
        <field name="model">is.purchase.order.line.colis.line</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group>
                        <group>
                            <field name="colis_id"/>
                            <field name="nb"/>
                            <field name="longueur"/>
                            <field name="note"/>
                            <field name="surface"/>
                            <field name="poids"/>
                            <field name="forfait_coupe"/>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>
    <record model="ir.ui.view" id="is_purchase_order_line_colis_line_tree_view">
        <field name="name">is_purchase_order_line_colis_line_tree_view</field>
        <field name="model">is.purchase.order.line.colis.line</field>
        <field name="type">tree</field>
        <field name="arch" type="xml">
            <tree editable="top" create="0">
                <field name="order_line_id"/>
                <field name="colis_ids" widget="many2many_tags"/>
                <field name="colis_id" domain="[('id', 'in', colis_ids)]"/> 
                <field name="nb"            sum="Total"/>
                <field name="longueur"      sum="Total"/>
                <field name="note"/>
                <field name="surface"       sum="Total"/>
                <field name="poids"         sum="Total"/>
                <field name="forfait_coupe" sum="Total"/>
            </tree>
        </field>
    </record>


    <record id="is_purchase_order_line_colis_line_kanban_view" model="ir.ui.view">
        <field name="name">is_purchase_order_line_colis_line_kanban_view</field>
        <field name="model">is.purchase.order.line.colis.line</field>
        <field name="arch" type="xml">
            <kanban sample="1">
                <field name="id"/>
                <field name="colis_id"/>
                <field name="nb"/>
                <field name="longueur"/>
                <field name="surface"/>
                <field name="poids"/>
                <field name="surface"/>
                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_card oe_kanban_global_click">
                             <div class="oe_kanban_details">
                                <div class="o_kanban_record_top mb-0">
                                    <div class="o_kanban_record_headings">
                                        <strong class="o_kanban_record_title">
                                            <field name="id"/>
                                        </strong>
                                    </div>
                                </div>
                                <div><field name="nb"/> / <field name="longueur"/> / <field name="surface"/></div>
                                <div>Poids ligne : <field name="poids"/></div>
                                <div><b>Poids colis : <field name="poids_colis"/></b></div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>
    <record id="is_purchase_order_line_colis_line_search_view" model="ir.ui.view">
        <field name="name">is_purchase_order_line_colis_line_search_view</field>
        <field name="model">is.purchase.order.line.colis.line</field>
        <field name="arch" type="xml">
            <search>
                <field name="colis_id" />
                <group string="Group By">
                    <filter name="group_colis_id" string="Colis" context="{'group_by':'colis_id'}"/>
                </group>
            </search>
        </field>
    </record>
    <record id="is_purchase_order_line_colis_line_action" model="ir.actions.act_window">
        <field name="name">Finitions</field>
        <field name="res_model">is.purchase.order.line.colis.line</field>
        <field name="view_mode">tree,form,kanban</field>
    </record>



</odoo>

